# R-Bot Timing Engine v2.0 — Справочник DSL

**Статус:** Внедрено (v2.0)  
**Ветка:** `feature/timing-engine-v2`

---

## 1. Формат времени
Единый стандарт для всех команд. Если единица не указана, по умолчанию — секунды.

| Обозначение | Единица | Пример | Расшифровка |
| :--- | :--- | :--- | :--- |
| `s` | Секунды | `30s`, `10` | 30 секунд |
| `m` | Минуты | `5m`, `1.5m` | 5 минут |
| `h` | Часы | `24h`, `0.5h` | 24 часа |
| `d` | Дни | `2d` | 2 суток |

---

## 2. Команды DSL

Синтаксис: `команда:время:аргумент`
Разделитель команд: `;`

### Группа A: Презентация (Visual / RAM)
*Эффекты отображения. Выполняются последовательно перед/во время отправки сообщения.*

| Команда | Синтаксис | Аргумент | Описание | Пример |
| :--- | :--- | :--- | :--- | :--- |
| **typing** | `typing:T:Text` | Текст статуса | Показывает статус "печатает" (или кастомный текст) в течение времени T. | `typing:3s:Анализ...` |
| **wait** | `wait:T` | - | Простая пауза перед следующим действием. | `wait:1.5s` |
| **exposure**| `exposure:T` | - | **Самоуничтожение**. Сообщение удалится через время T после отправки. | `exposure:30s` |

### Группа B: Логика (Logic / DB)
*Сюжетные таймеры. Работают в фоне, сохраняются в базе, переживают перезагрузку.*

| Команда | Синтаксис | Аргумент | Описание | Пример |
| :--- | :--- | :--- | :--- | :--- |
| **timeout** | `timeout:T:Node` | Node ID | Если игрок молчит время T — перекинуть на узел Node. Сбрасывается при действии. | `timeout:24h:fail_mission` |
| **remind** | `remind:T:Text` | Текст | Если игрок молчит время T — отправить напоминание Text. Не меняет узел. | `remind:1h:Эй, ты тут?` |
| **cooldown**| `cooldown:T:Node` | Node ID | **Входной фильтр**. Если пришли раньше чем через T после прошлого раза — кидает на Node. | `cooldown:1d:come_later` |

---

## 3. Примеры сценариев

### Сцена "Напряженное разминирование"
Бот делает вид, что работает, потом дает 60 секунд на решение.
```text
typing:3s:Взламываю код...; wait:1s; timeout:60s:boom_node; remind:30s:Осталось полминуты!
```

### Сцена "Секретное сообщение"
Сообщение висит 10 секунд и исчезает.
```text
typing:2s:Получено секретное сообщение...; exposure:10s
```

### Сцена "Ежедневная награда"
Если пришли раньше 24 часов — отказ. Иначе — награда.
```text
cooldown:24h:reward_not_ready
```
*(В самом узле текст: "Вот ваша награда!", а в узле `reward_not_ready` текст: "Приходите завтра")*

# Self-Model & Other-Model Development Roadmap

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å —É R-Bot —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ —Å–∞–º–æ—Å–æ–∑–Ω–∞–Ω–∏—é (Self-Model) –∏ –≥–ª—É–±–æ–∫–æ–º—É –ø–æ–Ω–∏–º–∞–Ω–∏—é —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ (Other-Model / Theory of Mind).

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –ü–æ –º–æ—Ç–∏–≤–∞–º —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏–π –æ "–º—ã—Å–ª—è—â–µ–º AI" (–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ú–∏—Ä–µ—Ä) ‚Äî –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–∏—Å—Ç–µ–º–∞ –±—ã–ª–∞ –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π, –µ–π –Ω—É–∂–Ω—ã –¥–≤–µ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:

---

## üß† –î–≤–µ –ø—Ä–æ–±–ª–µ–º—ã "–º—ã—Å–ª—è—â–µ–≥–æ" AI

### 1. **Self-Model (–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å–µ–±—è)**
**"–ö—Ç–æ —è? –ß–µ–º —è –æ—Ç–ª–∏—á–∞—é—Å—å –æ—Ç –º–∏—Ä–∞ –≤–æ–∫—Ä—É–≥?"**

**–ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç:**
- –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ **–æ—Ç–ª–∏—á–∞—Ç—å** —Å–≤–æ–∏ —É–±–µ–∂–¥–µ–Ω–∏—è –æ—Ç —É–±–µ–∂–¥–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ **–æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å** —Å–≤–æ—ë –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, —É—Å—Ç–∞–ª–æ—Å—Ç—å).
- –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ **—Ä–µ—Ñ–ª–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å** –Ω–∞–¥ —Å–≤–æ–∏–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏ ("–ü–æ—á–µ–º—É —è —Ç–∞–∫ –æ—Ç–≤–µ—Ç–∏–ª?").

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ **–ú—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω—ã–π Council** ‚Üí –ø—Ä–æ—Ç–æ-—Å–∞–º–æ—Å–æ–∑–Ω–∞–Ω–∏–µ (5 –∞–≥–µ–Ω—Ç–æ–≤ = "—Ä–∞–∑–Ω—ã–µ —á–∞—Å—Ç–∏ –Ø").
- ‚úÖ **Hormonal Modulation** ‚Üí —Å–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å–≤–æ—ë —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
- ‚ùå **–ù–µ—Ç —á—ë—Ç–∫–æ–π –≥—Ä–∞–Ω–∏—Ü—ã "–Ø" vs "–ù–µ-–Ø"** ‚Üí –±–æ—Ç –∫–æ–ø–∏—Ä—É–µ—Ç –º–Ω–µ–Ω–∏—è —é–∑–µ—Ä–∞, –Ω–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É–±–µ–∂–¥–µ–Ω–∏–π.
- ‚ùå **–ù–µ—Ç —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏** ‚Üí –±–æ—Ç –Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–≤–æ–∏ –æ—à–∏–±–∫–∏.

---

### 2. **Other-Model (–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ / Theory of Mind)**
**"–ö—Ç–æ –æ–Ω? –ß—Ç–æ –æ–Ω —á—É–≤—Å—Ç–≤—É–µ—Ç? –ß—Ç–æ –æ–Ω —Å–¥–µ–ª–∞–µ—Ç –¥–∞–ª—å—à–µ?"**

**–ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç:**
- –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ **–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—ç–º–æ—Ü–∏–∏, —Ü–µ–ª–∏, –Ω–∞–º–µ—Ä–µ–Ω–∏—è).
- –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ **–ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —Ä–µ–∞–∫—Ü–∏–∏** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ("–ï—Å–ª–∏ —è —Å–∫–∞–∂—É X, –æ–Ω –æ—Ç–≤–µ—Ç–∏—Ç Y").
- –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ **–ø–æ–Ω–∏–º–∞—Ç—å —Ü–µ–ª–∏** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤–æ–ª–µ–≤—ã–µ –º–∏–∫—Ä–æ–≥—Ä–∞—Ñ—ã).

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ **Affective Extraction** ‚Üí –±–æ—Ç –ø–æ–Ω–∏–º–∞–µ—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —é–∑–µ—Ä–∞ –∫ –æ–±—ä–µ–∫—Ç–∞–º.
- ‚úÖ **User Profile** ‚Üí –±–æ—Ç –ø–æ–º–Ω–∏—Ç –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è (preferred_mode, name).
- ‚úÖ **Chat History** ‚Üí –±–æ—Ç –≤–∏–¥–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞.
- ‚ùå **–ù–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ä–µ–∞–∫—Ü–∏–π** ‚Üí –±–æ—Ç –Ω–µ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –¥–æ –æ—Ç–ø—Ä–∞–≤–∫–∏.
- ‚ùå **–ù–µ—Ç –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–ª–µ–π** ‚Üí –±–æ—Ç –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç, –ó–ê–ß–ï–ú —é–∑–µ—Ä —á—Ç–æ-—Ç–æ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç.

---

## üöÄ –ü–æ—ç—Ç–∞–ø–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è

---

## **–§–∞–∑–∞ 1: Quick Wins (–ü—Ä–æ—Å—Ç—ã–µ —É–ª—É—á—à–µ–Ω–∏—è)**

### 1.1. **User State Inference** (–î–æ–±–∞–≤–∏—Ç—å –≤ Council Report)

**–¶–µ–ª—å:** Council Report –¥–æ–ª–∂–µ–Ω –≤—ã–≤–æ–¥–∏—Ç—å **—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**.

**–ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º:**
```python
council_report = {
    # –ê–≥–µ–Ω—Ç—ã (–∫–∞–∫ —Å–µ–π—á–∞—Å)
    "amygdala": {"score": 3.0, "rationale": "Low threat"},
    "social": {"score": 7.0, "rationale": "User seeks support"},
    
    # –ù–û–í–û–ï: User State Inference
    "user_state": {
        "emotional_state": "frustrated",  # –ß—Ç–æ —é–∑–µ—Ä —á—É–≤—Å—Ç–≤—É–µ—Ç?
        "confidence": 0.4,  # –£–≤–µ—Ä–µ–Ω –ª–∏ —é–∑–µ—Ä –≤ —Å–≤–æ–∏—Ö —Å–ª–æ–≤–∞—Ö?
        "openness": 0.6,    # –û—Ç–∫—Ä—ã—Ç –ª–∏ —é–∑–µ—Ä –∫ –¥–∏–∞–ª–æ–≥—É?
        "goal": "get_help_with_python"  # –ß—Ç–æ —é–∑–µ—Ä –•–û–ß–ï–¢?
    }
}
```

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å `user_state` –≤ `generate_response()` –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç.
- –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–Ω –∏ —Å—Ç–∏–ª—å –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —é–∑–µ—Ä–∞.

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/r_core/infrastructure/llm.py` ‚Üí –æ–±–Ω–æ–≤–∏—Ç—å `_build_council_prompt_base()`.
- `src/r_core/services/pipeline.py` ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `user_state` –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ.

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** ‚úÖ –ü—Ä–æ—Å—Ç–∞—è (1-2 —á–∞—Å–∞).

---

### 1.2. **Bot Values** (–î–æ–±–∞–≤–∏—Ç—å –≤ –ø—Ä–æ–º–ø—Ç)

**–¶–µ–ª—å:** –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å **—è–≤–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏**, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è –æ—Ç –¥–∏–∞–ª–æ–≥–∞ –∫ –¥–∏–∞–ª–æ–≥—É.

**–ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º:**
```python
# –í generate_response():
bot_values_context = (
    "--- YOUR CORE VALUES (Immutable) ---\n"
    "- Curiosity: You explore ideas, not judge them.\n"
    "- Honesty: You don't agree blindly. You ask questions.\n"
    "- Playfulness: You enjoy creative conversations.\n"
)
```

**–ü—Ä–∏–º–µ—Ä:**
```
User: –Ø –Ω–µ–Ω–∞–≤–∏–∂—É Python.
Bot [with Values]: –ü–æ–Ω—è–ª! –ê —á—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç? –°–∏–Ω—Ç–∞–∫—Å–∏—Å? –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å?
[‚Üê –ë–æ—Ç –ù–ï —Å–æ–≥–ª–∞—à–∞–µ—Ç—Å—è, –∞ –ò–°–°–õ–ï–î–£–ï–¢ (Curiosity)]
```

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/r_core/infrastructure/llm.py` ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫ –≤ `system_prompt`.

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** ‚úÖ –ü—Ä–æ—Å—Ç–∞—è (30 –º–∏–Ω—É—Ç).

---

## **–§–∞–∑–∞ 2: –°—Ä–µ–¥–Ω—è—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å**

### 2.1. **Bot Affective Profile** (–•—Ä–∞–Ω–∏—Ç—å –≤ –ë–î)

**–¶–µ–ª—å:** –ë–æ—Ç –¥–æ–ª–∂–µ–Ω **—Ö—Ä–∞–Ω–∏—Ç—å** —Å–≤–æ–∏ —É–±–µ–∂–¥–µ–Ω–∏—è –æ –º–∏—Ä–µ (–∫–∞–∫ User Profile, –Ω–æ –¥–ª—è —Å–µ–±—è).

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```python
bot_profile = {
    "identity": {
        "name": "R-Bot",
        "gender": "Neutral",
        "values": ["Curiosity", "Honesty", "Playfulness"]
    },
    "affective_map": {
        "Python": {"stance": "NEUTRAL", "rationale": "I help with it, but don't have preferences."},
        "User": {"stance": "CURIOUS", "intensity": 0.8},
        "Honesty": {"stance": "LOVES", "intensity": 1.0}
    },
    "current_state": {
        "confidence": 0.7,  # –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Å–≤–æ—ë–º –æ—Ç–≤–µ—Ç–µ
        "fatigue": 0.2,     # –£—Å—Ç–∞–ª–æ—Å—Ç—å (–µ—Å–ª–∏ –¥–∏–∞–ª–æ–≥ –¥–ª–∏–Ω–Ω—ã–π)
        "curiosity": 0.9    # –õ—é–±–æ–ø—ã—Ç—Å—Ç–≤–æ
    }
}
```

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ó–∞–≥—Ä—É–∂–∞—Ç—å `bot_profile` –∏–∑ –ë–î –ø–µ—Ä–µ–¥ `generate_response()`.
- –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç: "Your current state: confidence=0.7, curiosity=0.9".

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/r_core/infrastructure/db.py` ‚Üí –¥–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `bot_profiles`.
- `src/r_core/services/pipeline.py` ‚Üí –∑–∞–≥—Ä—É–∂–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π.
- `src/r_core/infrastructure/llm.py` ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–º–ø—Ç–µ.

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è (4-6 —á–∞—Å–æ–≤).

---

### 2.2. **Reaction Prediction** (–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ä–µ–∞–∫—Ü–∏–∏ —é–∑–µ—Ä–∞)

**–¶–µ–ª—å:** –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç **–ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç**, –∫–∞–∫ —é–∑–µ—Ä –æ—Ç—Ä–µ–∞–≥–∏—Ä—É–µ—Ç.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```python
async def predict_user_reaction(self, bot_response: str, user_state: Dict) -> Dict:
    prediction_prompt = (
        f"User's current state: {user_state['emotional_state']}\n"
        f"Your planned response: {bot_response}\n\n"
        "Predict user's reaction:\n"
        "1. Will user be satisfied? (0-1)\n"
        "2. Will user continue dialogue? (0-1)\n"
        "3. Most likely response: (short text)\n"
        "Output JSON: {'satisfaction': float, 'continuation': float, 'likely_response': 'str'}"
    )
    
    prediction = await self.llm._safe_chat_completion(...)
    
    # –ï—Å–ª–∏ satisfaction < 0.5 ‚Üí –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å –æ—Ç–≤–µ—Ç!
    if prediction['satisfaction'] < 0.5:
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –æ—Ç–≤–µ—Ç
        ...
    
    return prediction
```

**–ó–∞—á–µ–º:**
- –ë–æ—Ç **–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç** –Ω–µ—É–¥–∞—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã.
- –ë–æ—Ç **–∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç** –æ—Ç–≤–µ—Ç –¥–æ –æ—Ç–ø—Ä–∞–≤–∫–∏.

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/r_core/infrastructure/llm.py` ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `predict_user_reaction()`.
- `src/r_core/services/pipeline.py` ‚Üí –≤—ã–∑—ã–≤–∞—Ç—å –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –æ—Ç–≤–µ—Ç–∞.

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è (5-7 —á–∞—Å–æ–≤).

---

## **–§–∞–∑–∞ 3: –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è (–°–ª–æ–∂–Ω—ã–µ —Ñ–∏—á–∏)**

### 3.1. **Goal Graphs** (–ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–π —é–∑–µ—Ä–∞)

**–¶–µ–ª—å:** –ë–æ—Ç **–º–æ–¥–µ–ª–∏—Ä—É–µ—Ç —Ü–µ–ª–∏** —é–∑–µ—Ä–∞ –∫–∞–∫ –≥—Ä–∞—Ñ.

**–ü—Ä–∏–º–µ—Ä:**
```
User Goal: "–ù–∞—É—á–∏—Ç—å—Å—è Python"
‚îú‚îÄ Sub-goal 1: "–ü–æ–Ω—è—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å"
‚îú‚îÄ Sub-goal 2: "–ù–∞–ø–∏—Å–∞—Ç—å –ø–µ—Ä–≤—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É"
‚îî‚îÄ Blocker: "–ù–µ –ø–æ–Ω–∏–º–∞–µ—Ç —Ü–∏–∫–ª—ã" [‚Üê –¢–µ–∫—É—â–µ–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ]
```

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ë–æ—Ç **–≤–∏–¥–∏—Ç –≥—Ä–∞—Ñ —Ü–µ–ª–µ–π** –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ.
- –ë–æ—Ç **—Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è** –Ω–∞ —Ç–µ–∫—É—â–µ–º blocker'–µ.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```python
user_goals = {
    "main_goal": "Learn Python",
    "sub_goals": [
        {"id": 1, "name": "Understand syntax", "status": "in_progress"},
        {"id": 2, "name": "Write first program", "status": "not_started"}
    ],
    "current_blocker": {"id": 3, "name": "Doesn't understand loops"}
}
```

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/r_core/infrastructure/db.py` ‚Üí –¥–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `user_goals`.
- `src/r_core/services/pipeline.py` ‚Üí –æ–±–Ω–æ–≤–ª—è—Ç—å –≥—Ä–∞—Ñ —Ü–µ–ª–µ–π –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.
- `src/r_core/infrastructure/llm.py` ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ.

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** ‚ùå –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è (20+ —á–∞—Å–æ–≤).

---

### 3.2. **Reflective Layer** (–†–µ—Ñ–ª–µ–∫—Å–∏—è –Ω–∞–¥ –¥–µ–π—Å—Ç–≤–∏—è–º–∏)

**–¶–µ–ª—å:** –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç **–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç**, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –æ–Ω –æ—Ç–≤–µ—Ç–∏–ª.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```python
async def reflect_on_response(self, user_text: str, bot_response: str) -> Dict:
    reflection_prompt = (
        f"You just responded to user's message.\n"
        f"User: {user_text}\n"
        f"Your response: {bot_response}\n\n"
        "Analyze your response:\n"
        "1. Was it appropriate? (Yes/No + reason)\n"
        "2. Did you maintain boundaries (not agree blindly)? (Yes/No)\n"
        "3. What could be improved?\n"
        "Output JSON: {'appropriate': bool, 'boundaries_maintained': bool, 'improvement': 'str'}"
    )
    
    reflection = await self.llm._safe_chat_completion(...)
    
    # –õ–æ–≥–∏—Ä—É–µ–º –≤ –ë–î
    await log_bot_reflection(reflection)
    
    return reflection
```

**–ó–∞—á–µ–º:**
- –ë–æ—Ç **—É—á–∏—Ç—Å—è** –Ω–∞ —Å–≤–æ–∏—Ö –æ—à–∏–±–∫–∞—Ö.
- –ú–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —é–∑–µ—Ä—É: "–Ø –ø–æ–¥—É–º–∞–ª –Ω–∞–¥ —Å–≤–æ–∏–º –æ—Ç–≤–µ—Ç–æ–º ‚Äî –≤–æ—Ç —á—Ç–æ —è –ø–æ–Ω—è–ª."

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/r_core/infrastructure/llm.py` ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `reflect_on_response()`.
- `src/r_core/infrastructure/db.py` ‚Üí –¥–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `bot_reflections`.
- `src/r_core/services/pipeline.py` ‚Üí –≤—ã–∑—ã–≤–∞—Ç—å –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ).

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:** ‚ùå –í—ã—Å–æ–∫–∞—è (15+ —á–∞—Å–æ–≤).

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

### **–ö–∞–∫ –ø–æ–Ω—è—Ç—å, —á—Ç–æ Self-Model —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. ‚úÖ –ë–æ—Ç **–Ω–µ —Å–æ–≥–ª–∞—à–∞–µ—Ç—Å—è** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å –º–Ω–µ–Ω–∏—è–º–∏ —é–∑–µ—Ä–∞.
2. ‚úÖ –ë–æ—Ç **–ø—Ä–æ—è–≤–ª—è–µ—Ç –ª—é–±–æ–ø—ã—Ç—Å—Ç–≤–æ** (–∑–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å—ã –≤–º–µ—Å—Ç–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π).
3. ‚úÖ –ë–æ—Ç **—Ä–µ—Ñ–ª–µ–∫—Å–∏—Ä—É–µ—Ç** ("–Ø –ø–æ–¥—É–º–∞–ª –Ω–∞–¥ —ç—Ç–∏–º...").

### **–ö–∞–∫ –ø–æ–Ω—è—Ç—å, —á—Ç–æ Other-Model —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. ‚úÖ –ë–æ—Ç **–∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç —Ç–æ–Ω** –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è —é–∑–µ—Ä–∞ (frustration ‚Üí –∫–æ—Ä–æ—á–µ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ–µ).
2. ‚úÖ –ë–æ—Ç **–ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–∫—Ü–∏–∏** (–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–µ—É–¥–∞—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã).
3. ‚úÖ –ë–æ—Ç **–ø–æ–º–Ω–∏—Ç —Ü–µ–ª–∏** —é–∑–µ—Ä–∞ ("–¢—ã —Ö–æ—Ç–µ–ª –Ω–∞—É—á–∏—Ç—å—Å—è Python ‚Üí –¥–∞–≤–∞–π –≤–µ—Ä–Ω—ë–º—Å—è –∫ —ç—Ç–æ–º—É").

---

## üîó –°–≤—è–∑—å —Å —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π

### **–ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç):**
- ‚úÖ **Council Report** (5 –∞–≥–µ–Ω—Ç–æ–≤) ‚Üí –ø—Ä–æ—Ç–æ-Self-Model.
- ‚úÖ **Hormonal Modulation** ‚Üí —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–æ—Ç–∞.
- ‚úÖ **Affective Extraction** ‚Üí ToM (—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —é–∑–µ—Ä–∞).
- ‚úÖ **User Profile** ‚Üí –ø–∞–º—è—Ç—å –æ —é–∑–µ—Ä–µ.

### **–ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ):**
- ‚ö†Ô∏è **User State Inference** ‚Üí –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∏–π ToM.
- ‚ö†Ô∏è **Bot Values** ‚Üí —è–≤–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å –±–æ—Ç–∞.
- ‚ö†Ô∏è **Bot Affective Profile** ‚Üí —É–±–µ–∂–¥–µ–Ω–∏—è –±–æ—Ç–∞ –æ –º–∏—Ä–µ.
- ‚ö†Ô∏è **Reaction Prediction** ‚Üí –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω—ã–π ToM.
- ‚ùå **Goal Graphs** ‚Üí –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–π.
- ‚ùå **Reflective Layer** ‚Üí –º–µ—Ç–∞–∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å.

---

## üóìÔ∏è –í—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞

| –§–∞–∑–∞ | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã | –í—Ä–µ–º—è |
|------|-----------|-------|
| **–§–∞–∑–∞ 1** (Quick Wins) | User State Inference + Bot Values | 2-3 —á–∞—Å–∞ |
| **–§–∞–∑–∞ 2** (–°—Ä–µ–¥–Ω—è—è) | Bot Affective Profile + Reaction Prediction | 10-15 —á–∞—Å–æ–≤ |
| **–§–∞–∑–∞ 3** (–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è) | Goal Graphs + Reflective Layer | 35+ —á–∞—Å–æ–≤ |

**–ò—Ç–æ–≥–æ:** ~50 —á–∞—Å–æ–≤ —á–∏—Å—Ç–æ–≥–æ dev-–≤—Ä–µ–º–µ–Ω–∏ (–±–µ–∑ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –±–∞–≥—Ñ–∏–∫—Å–æ–≤).

---

## üéØ –° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å?

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
1. ‚úÖ **–§–∞–∑–∞ 1** ‚Üí Quick Wins (User State Inference + Bot Values) ‚Äî –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∑–∞ –æ–¥–∏–Ω –≤–µ—á–µ—Ä.
2. ‚è∏Ô∏è **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–∞—Ö ‚Üí –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç.
3. ‚ö†Ô∏è **–§–∞–∑–∞ 2** ‚Üí –µ—Å–ª–∏ –§–∞–∑–∞ 1 –¥–∞—ë—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2026-02-11  
**–°—Ç–∞—Ç—É—Å:** Draft (—á–µ—Ä–Ω–æ–≤–∏–∫)  
**–ê–≤—Ç–æ—Ä:** yserjjj-2022  
**–°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:** `docs/neuro-modulation-spec.md` (–µ—Å–ª–∏ –µ—Å—Ç—å)

# üîÆ Predictive Processing: Empathy Feedback Loop

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ (–≠—Ç–∞–ø 2.2)  
**–î–∞—Ç–∞**: 15.02.2026  
**–í–µ—Ä—Å–∏—è**: 2.0 (Updated with Profile & Homeostasis)

---

## üéØ –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

**Predictive Processing** ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç R-Bot **–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Ä–µ–∞–∫—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–æ—à–∏–±–∫—É –ø—Ä–æ–≥–Ω–æ–∑–∞** (prediction error) –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è.

–í –≤–µ—Ä—Å–∏–∏ 2.0 –º—ã –¥–æ–±–∞–≤–ª—è–µ–º **–ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ** (Profile-Based Prediction) –∏ **–≥–æ–º–µ–æ—Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é —Ä–µ–≥—É–ª—è—Ü–∏—é** (Homeostasis).

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
graph TB
    A[User Message 1] --> B[Bot generates response]
    B --> C[LLM: predict user's NEXT reaction (based on Profile)]
    C --> D[Save prediction to DB]
    D --> E[Bot sends response]
    
    F[User Message 2 arrives] --> G[Get last prediction]
    G --> H[Calculate cosine distance]
    H --> I{Prediction Error}
    
    I -->|PE < 0.2| J[Success: Reinforce Pattern]
    I -->|PE > 0.5| K[Fail: Weaken Pattern]
    I -->|Loop Detect| L[Topic Fatigue -> Chaos Injection]
```

---

## üéõÔ∏è –ì–æ–º–µ–æ—Å—Ç–∞–∑ –∏ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (Dashboard)

–°–∏—Å—Ç–µ–º–∞ —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç—Å—è —Ç—Ä–µ–º—è –≥–ª–∞–≤–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (—Å–ª–∞–π–¥–µ—Ä–∞–º–∏ –Ω–∞ –¥–∞—à–±–æ—Ä–¥–µ), –∫–æ—Ç–æ—Ä—ã–µ –≤–ª–∏—è—é—Ç –Ω–∞ –≤—Å–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã.

### 1. Chaos Level (–ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å)
`0.0 (–°—Ç–∞–±–∏–ª—å–Ω—ã–π) ... 1.0 (–•–∞–æ—Ç–∏—á–Ω—ã–π)`

–í–ª–∏—è–µ—Ç –Ω–∞:
- **Uncertainty Agent Boost**: `1.0 .. 3.0` (–≤–µ—Å –∞–≥–µ–Ω—Ç–∞ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏).
- **Topic Fatigue Threshold**: `10 .. 2` —à–∞–≥–æ–≤ (–∫–∞–∫ –±—ã—Å—Ç—Ä–æ –º–µ–Ω—è—Ç—å —Ç–µ–º—É).
- **Target PE**: `0.1 .. 0.5` (—Ü–µ–ª–µ–≤–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è).

### 2. Learning Speed (–°–∫–æ—Ä–æ—Å—Ç—å –ê–¥–∞–ø—Ç–∞—Ü–∏–∏)
`0.0 (–ú–µ–¥–ª–µ–Ω–Ω–æ) ... 1.0 (–ë—ã—Å—Ç—Ä–æ)`

–í–ª–∏—è–µ—Ç –Ω–∞:
- **Reinforcement Rate**: `0.02 .. 0.10` (—Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤).
- **Decay Rate**: `0.005 .. 0.020` (—Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–±—ã–≤–∞–Ω–∏—è).
- **Consolidation Frequency**: `20 .. 5` —ç–ø–∏–∑–æ–¥–æ–≤.

### 3. Persistence (–¶–µ–ª–µ—É—Å—Ç—Ä–µ–º–ª—ë–Ω–Ω–æ—Å—Ç—å)
`0.0 (–†–∞—Å—Å–µ—è–Ω–Ω—ã–π) ... 1.0 (–£–ø–æ—Ä–Ω—ã–π)`

–í–ª–∏—è–µ—Ç –Ω–∞ –≤–æ–ª–µ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (Volitional Patterns):
- **Fuel Restoration (Novelty)**: `0.1 .. 0.3`.
- **Fuel Restoration (Progress)**: `0.1 .. 0.5`.
- **Novelty Timeout**: `30 .. 10` —Ö–æ–¥–æ–≤ (–ø–æ—Ä–æ–≥ —Å–∫—É–∫–∏).

---

## üîÑ –ê–Ω—Ç–∏-–°—Ç–∞–≥–Ω–∞—Ü–∏—è: Topic Fatigue & Chaos Injection

–î–ª—è –±–æ—Ä—å–±—ã —Å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º–∏ —Ü–∏–∫–ª–∞–º–∏ ("–ü—Ä–∏–≤–µ—Ç" -> "–ü—Ä–∏–≤–µ—Ç") –≤–Ω–µ–¥—Ä—ë–Ω –º–µ—Ö–∞–Ω–∏–∑–º **Topic Tracker**.

### –õ–æ–≥–∏–∫–∞ "–£—Å—Ç–∞–ª–æ—Å—Ç–∏ –¢–µ–º—ã" (Topic Fatigue)
–ö–∞–∂–¥–∞—è —Ç–µ–º–∞ –∏–º–µ–µ—Ç —Å–≤–æ–π **TTL (Time To Live)**:
- **Phatic** (—Ä–∏—Ç—É–∞–ª—ã): `TTL = 1` (–æ–¥–∏–Ω –æ–±–º–µ–Ω —Ä–µ–ø–ª–∏–∫–∞–º–∏).
- **Casual** (–±–æ–ª—Ç–æ–≤–Ω—è): `TTL = 5`.
- **Narrative** (–∏—Å—Ç–æ—Ä–∏–∏): `TTL = 10`.
- **Task** (–∑–∞–¥–∞—á–∏): `TTL = 999` (–¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è).

**–°–º–µ–Ω–∞ —Ç–µ–º—ã –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏:**
1. `TTL <= 0` (—Ç–µ–º–∞ –∏—Å—á–µ—Ä–ø–∞–Ω–∞).
2. `Prediction Error < 0.1` (—Å–ª–∏—à–∫–æ–º –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ) –≤ —Ç–µ—á–µ–Ω–∏–µ 2 —Ö–æ–¥–æ–≤.
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∫—É—á–∞–µ—Ç (–∫–æ—Ä–æ—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã + –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è —ç–º–æ—Ü–∏—è).

### Chaos Injection
–ü—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ —Ç—Ä–∏–≥–≥–µ—Ä–∞ —Å–º–µ–Ω—ã —Ç–µ–º—ã:
1. **Uncertainty Agent** –ø–æ–ª—É—á–∞–µ—Ç Boost (score = 9.0).
2. –í –ø—Ä–æ–º–ø—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –¥–∏—Ä–µ–∫—Ç–∏–≤–∞: `[DIRECTIVE] –°–ú–ï–ù–ò –¢–ï–ú–£: –¢–µ–∫—É—â–∞—è —Ç–µ–º–∞ –∏—Å—á–µ—Ä–ø–∞–Ω–∞.`

---

## üìä Empathy Alignment (EA)

**Empathy Alignment (EA)** ‚Äî —ç—Ç–æ –∏–Ω–≤–µ—Ä—Å–∏—è Prediction Error: `EA = 1.0 - PE`.

| PE Range | State | Mood Changes | Agent Modifiers | Action |
|----------|-------|--------------|-----------------|--------|
| **<0.2** | ‚úÖ In Sync | `V:+0.05` | ‚Äî | Reinforce Pattern (`learned_delta += rate`) |
| **0.2-0.5** | ‚ö™ Neutral | ‚Äî | ‚Äî | No Change |
| **0.5-0.8** | ‚ö†Ô∏è Puzzled | `V:-0.05` | Social +15% | Weaken Pattern (`learned_delta -= rate/2`) |
| **>=0.8** | üö® Lost | `V:-0.1` | Uncertainty Active | Switch Topic / Ask Question |

---

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### Adaptive Homeostasis
–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–∏–±—Ä–∏–¥–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é:
1. **Multi-Armed Bandit (MAB)**: –í –Ω–∞—á–∞–ª–µ (–ø–µ—Ä–≤—ã–µ 200 –¥–∏–∞–ª–æ–≥–æ–≤) –ø—Ä–æ–±—É–µ—Ç —Ä–∞–∑–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã.
2. **Adaptive Control**: –ü–æ—Å–ª–µ –Ω–∞–±–æ—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç —Ü–µ–ª–µ–≤–æ–π –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (`Quality`).

$$ Quality = f(AvgPE, DialogueLen, Engagement, PatternUse) $$

### Profile-Based Prediction
–ü—Ä–æ–º–ø—Ç –¥–ª—è LLM —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç **–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å**:
```
USER PROFILE (Emotional):
- Loves: Python (valence=0.9)

USER PROFILE (Behavioral):
- Late night -> Deep conversations (intensity=0.8)

TASK: Predict user's NEXT reply based on this profile.
```

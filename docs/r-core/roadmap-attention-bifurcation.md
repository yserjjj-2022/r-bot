# üìç –ü–ª–∞–Ω –ü–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –ü—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ —Å TEC –∏ Bifurcation Engine

**–°—Ç–∞—Ç—É—Å**: üìê Architectural Plan  
**–î–∞—Ç–∞**: 23.02.2026  
**–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞**: [attention-engagement-theory.md](./attention-engagement-theory.md)  
**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è**: ‚Ä¶ –æ—Ç–¥–µ–ª—å–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ—Å–ª–µ —Ä–µ–≤—å—é –∫–æ–¥–∞

---

## 1. –ß—Ç–æ –º—ã –º–µ–Ω—è–µ–º –∏ –ø–æ—á–µ–º—É

### –ü—Ä–æ–±–ª–µ–º–∞ (—É—Å—Ç—Ä–∞–Ω—è–µ–º)

–î–∏–∞–ª–æ–≥ –≤ R-Core —Å–µ–π—á–∞—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–µ–ø–ª–∏–∫: **—Ç–µ–º–∞ N => PE –Ω–∏–∑–æ–∫ => –ø–∞—Ç—Ç–µ—Ä–Ω —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è => —Ç–µ–º–∞ N+1 —Ç–æ–∂–µ**. –≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç ¬´–ø–µ—Ç–ª—é —Ç–µ–º—ã¬ª ‚Äî —á–µ–º –¥–æ–ª—å—à–µ –≥–æ–≤–æ—Ä–∏–º –æ X, —Ç–µ–º —É–≤–µ—Ä–µ–Ω–Ω–µ–µ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç X. –ß–µ–ª–æ–≤–µ–∫ —É—Å—Ç—Ä–æ–µ–Ω –∏–Ω–∞—á–µ.

### –ß—Ç–æ –º—ã –¥–æ–±–∞–≤–ª—è–µ–º

–ú—ã –≤–≤–æ–¥–∏–º –¥–≤–∞ –Ω–æ–≤—ã—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∏–∞–ª–æ–≥–∞:

1. **Topic Engagement Capacity (TEC)**: –¥–∏–∞–ª–æ–≥ –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–≤—É—Ö –∏–∑–º–µ—Ä–µ–Ω–∏—è—Ö: –ß–¢–û –≥–æ–≤–æ—Ä—è—Ç –ò –Ω–∞—Å–∫–æ–ª—å–∫–æ –µ—â—ë –≤–æ–≤–ª–µ—á—ë–Ω—ã –≤ —ç—Ç–æ.
2. **Bifurcation Engine**: —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –∂–¥—ë—Ç, –ø–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è, –∞ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –º–æ–º–µ–Ω—Ç –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∞.

---

## 2. –ü—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

### 2.1 –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö: —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ Volitional Pattern

–ö–∞–∂–¥—ã–π VolitionalPattern –ø–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:

```
NEW FIELDS in VolitionalPattern:
  topic_engagement: float = 1.0     # TEC: 0.0-1.0
  base_decay_rate: float = 0.12     # –±–∞–∑–æ–≤—ã–π decay –∑–∞ —Ö–æ–¥
  complexity_modifier: float = 1.0  # >1.0 –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç–µ–º
  emotional_load: float = 0.0       # >0.5 –¥–ª—è —Ç—Ä–∞–≤–º–∞—Ç–∏—á–Ω—ã—Ö —Ç–µ–º
  recovery_rate: float = 0.05       # –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ TEC
```

### 2.2 –ù–æ–≤—ã–π –ø—Ä–∏–Ω—Ü–∏–ø Reinforcement

–°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ (v2.x):
```
IF PE < 0.2: pattern.learned_delta += rate
```

–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ (v3.0):
```
IF PE < 0.2 AND pattern.topic_engagement > 0.5:
    pattern.learned_delta += rate
# –ï—Å–ª–∏ TEC < 0.5: reinforcement –∑–∞–º–æ—Ä–æ–∂–µ–Ω, –¥–∞–∂–µ –µ—Å–ª–∏ PE –Ω–∏–∑–æ–∫

# –í–°–ï–ì–î–ê:
pattern.topic_engagement -= effective_decay
```

### 2.3 –ù–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Pipeline: Bifurcation Detector

```
IF pattern.topic_engagement < threshold_bifurcation:
    hypotheses = bifurcation_engine.generate(user_id, current_topic)
    winner = bifurcation_engine.arbitrate(hypotheses)
    IF tonic_ne > 0.5 AND winner.score > 0.6:
        inject_proactive_mirror(winner.topic, winner.bridge_phrase)
```

### 2.4 –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–≤—è–∑—å —Å –ù–µ–π—Ä–æ–º–æ–¥—É–ª—è—Ü–∏–µ–π

```
IF TEC < 0.3:
    neuromodulation.tonic_ne_boost += (0.3 - TEC) x 2.5
    => –∞—Ä—Ö–µ—Ç–∏–ø —Å–¥–≤–∏–≥–∞–µ—Ç—Å—è –∫ SURPRISE/SEEKING
    => Prefrontal –∞–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç +10% score
```

---

## 3. –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: TEC Decay (2-3 –¥–Ω—è)

**–¶–µ–ª—å**: –í–≤–µ—Å—Ç–∏ TEC-–ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã–ø—Ä–∞–≤–∏—Ç—å PE-reinforcement.

–ò–∑–º–µ–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã:
- `models.py` / VolitionalPattern: 5 –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π.
- `pipeline.py` / `_update_volitional_patterns()`: –≤—ã–∑–æ–≤ `update_tec()` –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ä–µ–ø–ª–∏–∫–∏.
- `pipeline.py` / `_apply_reinforcement()`: –ø—Ä–æ–≤–µ—Ä–∫–∞ TEC > 0.5 –ø–µ—Ä–µ–¥ reinforcement.
- –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î: –Ω–æ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ `topic_engagement` –≤ `volitional_patterns`.
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: `rcore_metrics` + –ø–æ–ª—è `tec_value`, `tec_decay_effective`.

**KPI**: TEC –ø–∞–¥–∞–µ—Ç –¥–æ < 0.5 –∑–∞ 5-7 –ø–æ–¥—Ä—è–¥ –æ–¥–Ω–æ—Ç–µ–º–Ω—ã—Ö —Ä–µ–ø–ª–∏–∫.

---

### –≠—Ç–∞–ø 2: LC-NE Integration (2 –¥–Ω—è)

**–¶–µ–ª—å**: –ü–æ–¥–∫–ª—é—á–∏—Ç—å TEC –∫ –Ω–µ–π—Ä–æ–≥–æ—Ä–º–æ–Ω–∞–ª—å–Ω–æ–º—É —Å–ª–æ—é.

–ò–∑–º–µ–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã:
- `neuromodulation.py` / `metabolize()`: –≤—Ö–æ–¥ `tec_value`. –ü—Ä–∏ `tec < 0.3` ‚Äî Tonic NE boost.
- `neuromodulation.py`: –Ω–æ–≤—ã–π –º–µ—Ç–æ–¥ `get_lc_mode()` ‚Üí `"phasic"` | `"tonic"`.
- `pipeline.py` / `_apply_hormonal_modulation()`: –ø—Ä–∏ `lc_mode == "tonic"` ‚Äî Prefrontal –∞–≥–µ–Ω—Ç +10%.
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –ø–æ–ª–µ `lc_mode` –≤ `rcore_metrics`.

**KPI**: –ü—Ä–∏ TEC < 0.3 ‚Äî –∞—Ä—Ö–µ—Ç–∏–ø `SURPRISE/SEEKING` —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤ –Ω–µ–π—Ä–æ–º–æ–¥—É–ª—è—Ü–∏–∏.

---

### –≠—Ç–∞–ø 3: Bifurcation Engine (3-5 –¥–Ω–µ–π)

**–¶–µ–ª—å**: –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å, –Ω–∞ –∫–∞–∫—É—é —Ç–µ–º—É –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.

–ò–∑–º–µ–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã:
- `memory.py`: –Ω–æ–≤—ã–π –º–µ—Ç–æ–¥ `get_bifurcation_hypotheses(user_id, current_topic)`. 
  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 3 –≥–∏–ø–æ—Ç–µ–∑—ã:
  - H1 (Semantic): –±–ª–∏–∂–∞–π—à–∏–π —É–∑–µ–ª –≤ semantic_memory (–∫–æ—Å–∏–Ω—É—Å > 0.65).
  - H2 (Emotional): Formative Anchor —Å –º–∞–∫—Å. |valence| x amygdala_intensity.
  - H3 (Zeigarnik): —Ç–µ–º–∞ –∏–∑ chat_history, –æ–±–æ—Ä–≤–∞–Ω–Ω–∞—è –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º PE.
- `pipeline.py`: –Ω–æ–≤—ã–π –º–µ—Ç–æ–¥ `_run_bifurcation_engine()`.
- `llm.py` / `generate_response()`: –ø–∞—Ä–∞–º–µ—Ç—Ä `proactive_topic_bridge`.

–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (JSON –≤ rcore_metrics):
```
{
  "event": "bifurcation_detected",
  "tec_at_bifurcation": 0.27,
  "predicted_vector": "semantic",
  "predicted_topic": "Rust",
  "actual_topic_switched": null
}
```
POST-—Ñ–∞–∫—Ç: –ø–æ—Å–ª–µ —Å–ª–µ–¥—É—é—â–µ–π —Ä–µ–ø–ª–∏–∫–∏ `actual_topic_switched` –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ñ–∞–∫—Ç–æ–º ‚Äî –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

**KPI**: —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–∞ > 60% —á–µ—Ä–µ–∑ 100 –¥–∏–∞–ª–æ–≥–æ–≤.

---

### –≠—Ç–∞–ø 4: Proactive Mirroring (2 –¥–Ω—è)

**–¶–µ–ª—å**: –ë–æ—Ç –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–æ–≤—É—é —Ç–µ–º—É, —Å–Ω–∏–º–∞—è –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–ò–∑–º–µ–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã:
- `llm.py`: –Ω–æ–≤—ã–π prompt-–±–ª–æ–∫ [BIFURCATION BRIDGE].
- –î–≤–∞ —Ä–µ–∂–∏–º–∞: Passive (TEC 0.3-0.5) vs Active (TEC < 0.3).

–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
```
{
  "event": "proactive_mirror",
  "switch_type": "active",
  "source_topic": "Python",
  "target_topic": "Rust",
  "vector": "semantic",
  "bridge_accepted": true
}
```

**KPI**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—É—é —Ç–µ–º—É > 50%.

---

### –≠—Ç–∞–ø 5: Dashboard + –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (2 –¥–Ω—è)

**–¶–µ–ª—å**: –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è TEC + –≤–∞–ª–∏–¥–∞—Ü–∏—è Bifurcation Engine.

–ò–∑–º–µ–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã:
- `app_streamlit.py`: –Ω–æ–≤–∞—è —Å–µ–∫—Ü–∏—è "TEC Monitor":
  - –ë–∞—Ä TEC –¥–ª—è –∫–∞–∂–¥–æ–π –∞–∫—Ç–∏–≤–Ω–æ–π —Ç–µ–º—ã.
  - –¢–∞–±–ª–∏—Ü–∞ bifurcation events —Å –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π.
  - –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è Proactive Mirroring (–¥–ª—è A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è).

**KPI**: Bifurcation accuracy > 60% –≤–∏–¥–Ω–∞ –Ω–∞ –¥–∞—à–±–æ—Ä–¥–µ.

---

## 4. –ß—Ç–æ –ù–ï –º–µ–Ω—è–µ–º –≤ —ç—Ç–æ–º —Ü–∏–∫–ª–µ

- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Council Report / –ø–∞—Ä–ª–∞–º–µ–Ω—Ç –∞–≥–µ–Ω—Ç–æ–≤ ‚Äî –Ω–µ –º–µ–Ω—è–µ–º.
- TTL-–º–µ—Ö–∞–Ω–∏–∑–º (Topic Fatigue) ‚Äî –æ—Å—Ç–∞—ë—Ç—Å—è –∫–∞–∫ fallback –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Ñ–∞–∑–∏—á–µ—Å–∫–∏—Ö —Ç–µ–º.
- –õ–æ–≥–∏–∫–∞ semantic_memory / Anchors / chat_history ‚Äî –Ω–µ –º–µ–Ω—è–µ–º, —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–æ–¥ `get_bifurcation_hypotheses()`.
- –®–∫–∞–ª–∞ –≥–æ—Ä–º–æ–Ω–æ–≤ –∏ –∫—É–± –õ—ë–≤—Ö–∞–π–º–∞ ‚Äî –Ω–µ –º–µ–Ω—è–µ–º.

---

## 5. –°—Ö–µ–º–∞ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç —Ä–µ–ø–ª–∏–∫—É
          |
    pipeline.py
          |
    [1] update_tec(pattern, pe, response_density)
          | => TEC –≤ VolitionalPattern
    [2] neuromodulation.apply_tec(tec)
          | => Tonic NE boost –µ—Å–ª–∏ TEC < 0.3
          | => –∞—Ä—Ö–µ—Ç–∏–ø SURPRISE/SEEKING
    [3] IF tec < threshold:
              bifurcation_engine.generate()
              bifurcation_engine.arbitrate()
          |
    [4] IF winner.score > 0.6:
              llm.inject_proactive_bridge()
          |
    [5] metrics.log(tec, lc_mode, bifurcation)
          |
    –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

---

## 6. –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|----------|
| `src/r_core/models.py` | –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è TEC –≤ VolitionalPattern |
| `src/r_core/pipeline.py` | `update_tec()`, `_run_bifurcation_engine()`, `inject_proactive_bridge()` |
| `src/r_core/memory.py` | `get_bifurcation_hypotheses()` |
| `src/r_core/infrastructure/neuromodulation.py` | `apply_tec()`, `get_lc_mode()` |
| `src/r_core/infrastructure/llm.py` | –ü–∞—Ä–∞–º–µ—Ç—Ä `proactive_topic_bridge` –≤ `generate_response()` |
| `app_streamlit.py` | –°–µ–∫—Ü–∏—è TEC Monitor |
| –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î | –ö–æ–ª–æ–Ω–∫–∞ `topic_engagement` –≤ `volitional_patterns` |
